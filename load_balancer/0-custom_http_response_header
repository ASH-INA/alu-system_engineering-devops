#!/bin/bash
# Exit script on error
set -e

# Update package list and install Nginx if not already installed
if ! command -v nginx &> /dev/null; then
    sudo apt update
    sudo apt install -y nginx
fi

# Get the hostname of the server
HOSTNAME=$(hostname)

# Create a backup of the default Nginx configuration file
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Configure Nginx to add the custom header
sudo sed -i '/server {/a \ \ \ \ add_header X-Served-By '"$HOSTNAME"';' /etc/nginx/sites-available/default

# Test Nginx configuration for errors
sudo nginx -t

# Reload Nginx to apply the new configuration
sudo systemctl reload nginx
